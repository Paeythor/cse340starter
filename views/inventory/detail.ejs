<%- include('../partials/header', { title: title, nav: nav }) %>

<main>
    <% if (locals.errors) { %>
        <ul class="notice">
            <% errors.array().forEach(error => { %>
                <li><%= error.msg %></li>
            <% }) %>
        </ul>
    <% } %>
    
    <h1><%= title %></h1>
    
    <section class="vehicle-detail-wrapper">
        <div class="vehicle-detail-container">
            <!-- Vehicle Image Section -->
            <div class="vehicle-image-section">
                <img src="<%= vehicle.inv_image || '/images/no-image.png' %>" 
                     alt="<%= vehicle.inv_year %> <%= vehicle.inv_make %> <%= vehicle.inv_model %>"
                     class="vehicle-main-image">
            </div>
            
            <!-- Vehicle Information Section -->
            <div class="vehicle-info">
                <!-- Price and Mileage Prominent Display -->
                <div class="price-mileage-section">
                    <div class="mileage-display">
                        <span class="mileage-label">Mileage</span>
                        <span class="mileage-value">
                            <%= vehicle.inv_miles ? vehicle.inv_miles.toLocaleString() : 'N/A' %>
                        </span>
                    </div>
                    <div class="price-display">
                        <span class="price-label">No-Haggle Price</span>
                        <span class="price-value">
                            $<%= vehicle.inv_price ? vehicle.inv_price.toLocaleString() : 'N/A' %>
                        </span>
                    </div>
                </div>

                <!-- Vehicle Title -->
                <h2><%= vehicle.inv_year %> <%= vehicle.inv_make %> <%= vehicle.inv_model %> <%= vehicle.inv_trim || '' %></h2>
                
                <!-- Vehicle Specifications Grid -->
                <div class="vehicle-specs">
                    <div class="specs-grid">
                        <div class="spec-item">
                            <span class="spec-label">Mileage:</span>
                            <span class="spec-value"><%= vehicle.inv_miles ? vehicle.inv_miles.toLocaleString() : 'N/A' %></span>
                        </div>
                        <div class="spec-item">
                            <span class="spec-label">MPG:</span>
                            <span class="spec-value">
                                <%= vehicle.inv_mpg_city || 'N/A' %>/<%= vehicle.inv_mpg_highway || 'N/A' %> (City/Hwy)
                            </span>
                        </div>
                        <div class="spec-item">
                            <span class="spec-label">Engine:</span>
                            <span class="spec-value">Unknown</span>
                        </div>
                        <div class="spec-item">
                            <span class="spec-label">Int. Color:</span>
                            <span class="spec-value"><%= vehicle.inv_interior_color || 'Unknown' %></span>
                        </div>
                        <div class="spec-item">
                            <span class="spec-label">Fuel Type:</span>
                            <span class="spec-value"><%= vehicle.inv_fuel || 'Gasoline' %></span>
                        </div>
                        <div class="spec-item">
                            <span class="spec-label">Drivetrain:</span>
                            <span class="spec-value"><%= vehicle.inv_drive || 'Unknown' %></span>
                        </div>
                        <div class="spec-item">
                            <span class="spec-label">Transmission:</span>
                            <span class="spec-value"><%= vehicle.inv_transmission || 'Unknown' %></span>
                        </div>
                        <div class="spec-item">
                            <span class="spec-label">Stock #:</span>
                            <span class="spec-value"><%= vehicle.inv_stock || 'N/A' %></span>
                        </div>
                        <div class="spec-item">
                            <span class="spec-label">VIN:</span>
                            <span class="spec-value"><%= vehicle.inv_vin || 'N/A' %></span>
                        </div>
                    </div>
                </div>

                <!-- Action Buttons -->
                <div class="cta-buttons">
                    <a href="#" class="btn btn-primary">START MY PURCHASE</a>
                    <a href="/contact" class="btn btn-secondary">CONTACT US</a>
                    <a href="/schedule-test-drive" class="btn btn-outline">SCHEDULE TEST DRIVE</a>
                    <a href="/apply-financing" class="btn btn-outline">APPLY FOR FINANCING</a>
                </div>

                <!-- Contact Information -->
                <div class="contact-info">
                    <div class="contact-section">
                        <h4>Call Us</h4>
                        <a href="tel:+1-800-555-7886">+1 (800) 555-7886</a>
                    </div>
                    <div class="contact-section">
                        <h4>Visit Us</h4>
                        <span>CSE Motors</span>
                    </div>
                </div>

                <p class="disclaimer">* The principal prior use of this vehicle was as a Rental Vehicle.</p>
            </div>
        </div>
    </section>
    <!-- Existing vehicle detail code above -->

<!-- Reviews Section -->
<section class="vehicle-reviews">
  <h2>Leave a Review</h2>
  <form action="/reviews/add" method="POST" class="review-form">
    <!-- Use the correct property name for vehicle ID -->
    <input type="hidden" name="vehicleId" value="<%= vehicle.inv_id %>">

    <label for="name">Your Name:</label>
    <input type="text" id="name" name="name" placeholder="Your name" required>

    <label for="rating">Rating:</label>
    <select id="rating" name="rating" required>
      <% for(let i = 1; i <= 5; i++) { %>
        <option value="<%= i %>"><%= i %> Star<%= i > 1 ? 's' : '' %></option>
      <% } %>
    </select>

    <label for="comment">Comments:</label>
    <textarea id="comment" name="comment" placeholder="Your comments"></textarea>

    <button type="submit">Submit Review</button>
  </form>
</section>

</main>

<%- include('../partials/footer') %>

<style>

</style>
